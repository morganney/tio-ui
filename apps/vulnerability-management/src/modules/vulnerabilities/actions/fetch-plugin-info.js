import { STANDARD_API_ACTION } from 'tio-alloy';

import {
    PLUGIN_INFO_REQUEST,
    PLUGIN_INFO_SUCCESS,
    PLUGIN_INFO_ERROR
} from './types';

const fetchPluginInfo = (pluginId, range = 0, filters = '') => {
    return {
        type: STANDARD_API_ACTION,
        meta: {
            types: [
                PLUGIN_INFO_REQUEST,
                PLUGIN_INFO_SUCCESS,
                PLUGIN_INFO_ERROR
            ],
            // http://localhost:3000/api/workbenches/vulnerabilities/10688/info?date_range=0&filter.0.quality=eq&filter.0.filter=plugin.family_id&filter.0.value=45&filter.search_type=and
            request: `/workbenches/vulnerabilities/${pluginId}/info?date_range=${range}${filters}`
        }
    };
};

export { fetchPluginInfo };
