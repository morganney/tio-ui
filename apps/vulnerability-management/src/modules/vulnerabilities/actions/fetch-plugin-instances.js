import { STANDARD_API_ACTION } from 'tio-alloy';
import { getVulnInstances } from 'tio-vm/modules/vulnerabilities/utils';

import {
    PLUGIN_INSTANCES_REQUEST,
    PLUGIN_INSTANCES_SUCCESS,
    PLUGIN_INSTANCES_ERROR
} from './types';

export const fetchPluginInstances = (pluginId, range = 0, filters = '') => {
    return {
        type: STANDARD_API_ACTION,
        meta: {
            types: [
                PLUGIN_INSTANCES_REQUEST,
                PLUGIN_INSTANCES_SUCCESS,
                PLUGIN_INSTANCES_ERROR
            ],
            processResponseBeforeDispatch: getVulnInstances,
            request: `/workbenches/vulnerabilities/${pluginId}/outputs?date_range=${range}${filters}`
        }
    };
};
