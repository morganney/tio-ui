import React from 'react';

import { GraphBarView } from 'tio-vm/modules/common/components/presentations';
import { PluginStatsContainer } from 'tio-vm/modules/vulnerabilities/components/containers';
import { messages } from 'tio-vm/modules/vulnerabilities/messages';

const { ageGreaterThan90Days, age61To90Days, age31To60Days, age15To30Days, age0To14Days } = messages;

const getStats = (stats, data, total) => {
    return stats.map((stat, index) => {
        const value = typeof data[index] === 'undefined' ? 0 : data[index];

        return { ...stat, value, total };
    });
};
const renderPluginStats = (pluginStatsProps) => {
    const { intl, pluginStats, pluginsTotal } = pluginStatsProps;
    const stats = [
        { label: intl.formatMessage(ageGreaterThan90Days) },
        { label: intl.formatMessage(age61To90Days) },
        { label: intl.formatMessage(age31To60Days) },
        { label: intl.formatMessage(age15To30Days) },
        { label: intl.formatMessage(age0To14Days) }
    ];

    return <GraphBarView graphs={getStats(stats, pluginStats, pluginsTotal)} mt={3} />;
};

export const PluginStatsComponent = () => {
    return <PluginStatsContainer tioRender={renderPluginStats} />;
};
