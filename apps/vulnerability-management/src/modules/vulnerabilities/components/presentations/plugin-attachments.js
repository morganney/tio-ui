import React from 'react';
import PropTypes from 'prop-types';
import { Link } from '@hivekit/link';
import { PlanePreviewAttrItem } from '@hivekit/plane';

/*
TEMP : remove me
{
    'id': 7,
    'key': '9285a8e7fba1e04506d96830a1026ec5_2_a715d32a-b876-439a-ab14-620ef6af2242',
    'type': 'text',
    'name': 'host_tag_nix.log',
    'temp_token': '00fbb57e8d87d2bb8ab891969fb8a7011e2999697fffb10192422cd9654391a9'
},
https://qa-develop.cloud.aws.tenablesecurity.com/scans/1514/attachments/5
?key=f9d6117a79a3d9e58f7555be35a65fb2_2_a715d32a-b876-439a-ab14-620ef6af2242
&tempToken=4869872210020b7f40e7a25213b2d2cc223b1414ad80e5990886f84b6e22c83d
*/

// TODO make downloads work, pretty sure this won't work because we do not have a scanId from workbench flows
// and that is the reason attachment do not show on t.io today going this route
const renderAttachment = ({ id, key, name, temp_token: tempToken }) => {
    return (
        <div key={id}>
            <Link
                target='_blank'
                to={`/scans/{scanId}/attachments/${id}?key=${key}&tempToken=${tempToken}`}>
                {name}
            </Link>
        </div>
    );
};
renderAttachment.propTypes = {
    id: PropTypes.string,
    key: PropTypes.string,
    name: PropTypes.string,
    temp_token: PropTypes.string
};

// TODO intl - ATTACHMENTS
export const PluginAttachmentsView = ({ attachments }) => {
    return attachments
        ? (
            <PlanePreviewAttrItem label={'ATTACHMENTS'} span={true}>
                {attachments.map(renderAttachment)}
            </PlanePreviewAttrItem>
        ) : null;
};
PluginAttachmentsView.propTypes = {
    attachments: PropTypes.array
};
