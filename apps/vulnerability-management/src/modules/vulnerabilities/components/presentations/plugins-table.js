import React from 'react';
import PropTypes from 'prop-types';
import { Table } from '@hivekit/table';

import { CellSeverityIcon } from 'tio-vm/modules/common/components/presentations';

import { PluginTableActionsView } from './plugin-actions';

// TODO intl - columns
const checkboxColumn = {
    field: 'recastedSeverity',
    sort: 'desc'
};
const columns = [
    {
        headerName: 'name',
        field: 'plugin_name',
        width: 300,
        cellTooltip: (data) => { return `Plugin ID: ${data.plugin_id}`; }
    },
    {
        headerName: 'family',
        field: 'plugin_family'
    },
    {
        headerName: 'vulnerabilities',
        field: 'count',
        width: 80,
        sort: 'desc'
    },
    {
        headerName: '',
        field: 'actions',
        width: 80,
        suppressSorting: true,
        customCellRenderer: PluginTableActionsView
    }
];

export const PluginsTableView = ({ plugins, pluginsFetching, ...restProps }) => {
    return (
        <Table
            inheritHeight
            densityToggle={false}
            columns={columns}
            rows={plugins}
            checkboxIconComponent={CellSeverityIcon}
            checkboxProps={checkboxColumn}
            fetching={pluginsFetching}
            {...restProps} />
    );
};
PluginsTableView.propTypes = {
    plugins: PropTypes.array.isRequired,
    pluginsFetching: PropTypes.bool.isRequired
};
