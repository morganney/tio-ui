import React from 'react';

import { GraphBarView } from 'tio-vm/modules/common/components/presentations';
import { VulnAssetsStatsContainer } from 'tio-vm/modules/vulnerabilities/components/containers';

const stats = [
    { label: 'Exploitable By Malware' },
    { label: 'CANVAS Exploit Framework' },
    { label: 'Remotely Exploitable' },
    { label: 'Locally Exploitable' }
];
const getStats = (data, total) => {
    return stats.map((stat, index) => {
        const value = typeof data[index] === 'undefined' ? 0 : data[index];

        return { ...stat, value, total };
    });
};
const renderVulnAssetsStats = (vulnAssetStatsProps) => {
    const { vulnAssetsStats, vulnAssetsTotal } = vulnAssetStatsProps;

    return <GraphBarView graphs={getStats(vulnAssetsStats, vulnAssetsTotal)} mt={3} />;
};

export const VulnAssetsStatsComponent = () => {
    return <VulnAssetsStatsContainer tioRender={renderVulnAssetsStats} />;
};
