import React from 'react';
import PropTypes from 'prop-types';
import { colors } from '@hivekit/core';
import {
    StateActiveIcon,
    StateFixedIcon,
    StateNewIcon,
    StateResurfacedIcon,
    PlaceholderIcon
} from '@hivekit/icon';

const vulnStateIconMap = {
    Active: { Icon: StateActiveIcon, color: colors.statusOrange },
    Fixed: { Icon: StateFixedIcon, color: colors.actionBlueLight },
    New: { Icon: StateNewIcon, color: colors.statusGreen },
    Resurfaced: { Icon: StateResurfacedIcon, color: colors.statusRed }
};
const VulnStateIcon = ({ state, vulnerability_state: vulnerabilityState, size = 0 }) => {
    const vulnState = state || vulnerabilityState;
    const icon = vulnStateIconMap[vulnState] || { Icon: PlaceholderIcon, color: colors.grayLight };

    return <icon.Icon size={size} color={icon.color} data-tip={vulnState} />;
};
VulnStateIcon.propTypes = {
    size: PropTypes.number,
    state: PropTypes.string,
    vulnerability_state: PropTypes.string
};

const CellVulnStateIcon = (props) => {
    const { data } = props;

    return <VulnStateIcon {...data} {...props} />;
};
CellVulnStateIcon.propTypes = {
    data: PropTypes.object.isRequired
};

export {
    VulnStateIcon,
    CellVulnStateIcon
};
