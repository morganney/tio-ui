import React from 'react';
import { AssetGenericIcon } from '@hivekit/icon';

import { Utils } from 'tio-alloy';

const { dateFormat } = Utils;

// TEMP
const assetIcon = (assetType) => {
    return <AssetGenericIcon type={assetType} />;
};

// TODO intl - unknown
const assetName = (asset) => {
    try {
        return asset.agent_name[0] ||
              asset.netbios_name[0] ||
              asset.fqdn[0] ||
              asset.ipv4[0] ||
              'Unknown';
    } catch (ex) {
        return '';
    }
};

const assetNameTip = (asset) => {
    const fields = [
        asset.agent_name[0],
        asset.netbios_name[0],
        asset.fqdn[0],
        asset.ipv4[0]
    ];

    return fields
        .filter((field) => { return field; })
        .join('<br/>');
};

const assetIp = (asset) => {
    return asset.ipv4[0] || '';
};

const assetIpTip = (asset) => {
    return asset.ipv4.join('<br/>');
};

const assetOsTip = (asset) => {
    return asset.operating_system.join('<br/>');
};

// TODO: intl -- first seen
const assetLastSeenTip = (asset) => {
    const firstSeenArr = asset.sources.map((src) => {
        return new Date(src.first_seen);
    });
    const earliestFirstSeen = Math.min(...firstSeenArr);

    return `First Seen: ${dateFormat(earliestFirstSeen)}`;
};

export {
    assetIcon,
    assetIp,
    assetIpTip,
    assetLastSeenTip,
    assetName,
    assetNameTip,
    assetOsTip
};
