import React from 'react';
import PropTypes from 'prop-types';
import { Route } from 'react-router-dom';
import { MultiAssetIcon } from '@hivekit/icon';
import { Plane, PlaneFull, PlaneFullHeader } from '@hivekit/plane';

import { PlaneActionComponent, FilterRangeComponent } from 'tio-vm/modules/common/components';
import { routeClose } from 'tio-vm/modules/common/utils';
import {
    PLANE_FULL,
    ROUTE_ASSET_BASE
} from 'tio-vm/constants';
import {
    AssetsComponent,
    AssetsStatsComponent
} from 'tio-vm/modules/assets/components';

import { PlaneAssetPreviewView } from './plane-asset-preview';

export class PlaneAssetBaseView extends React.Component {
    static propTypes = {
        match: PropTypes.object.isRequired
    };

    constructor () {
        super();
        this.onPlaneClose = this.onPlaneClose.bind(this);
        this.renderHeader = this.renderHeader.bind(this);
        this.renderContent = this.renderContent.bind(this);
        this.renderFull = this.renderFull.bind(this);
    }

    onPlaneClose () {
        routeClose(ROUTE_ASSET_BASE, this.props);
    }

    renderHeader () {
        // TODO intl - Assets
        // TODO move to separate view : asset header

        return (
            <React.Fragment>
                <PlaneFullHeader
                    title='Assets'
                    icon={<MultiAssetIcon />}>
                    <AssetsStatsComponent />
                </PlaneFullHeader>
                <FilterRangeComponent />
            </React.Fragment>
        );
    }

    renderContent () {
        return <AssetsComponent />;
    }

    renderFull () {
        return <PlaneFull header={this.renderHeader()} content={this.renderContent()} />;
    }

    render () {
        const { match } = this.props;

        return (
            <React.Fragment>
                <Plane
                    display={PLANE_FULL}
                    closePlane={this.onPlaneClose}
                    full={this.renderFull}>
                    <Route path={`${match.path}/:assetid/:detail?`} component={PlaneAssetPreviewView} />
                </Plane>
                <PlaneActionComponent />
            </React.Fragment>
        );
    }
}
