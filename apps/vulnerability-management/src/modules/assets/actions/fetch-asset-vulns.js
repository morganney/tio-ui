import { STANDARD_API_ACTION } from 'tio-alloy';
import { vulnsPreprocessor } from 'tio-vm/modules/common/utils';

import {
    ASSET_VULNS_REQUEST,
    ASSET_VULNS_SUCCESS,
    ASSET_VULNS_ERROR
} from './types';

export const fetchAssetVulns = (assetId, range = 0, filters = '') => {
    return {
        type: STANDARD_API_ACTION,
        meta: {
            types: [
                ASSET_VULNS_REQUEST,
                ASSET_VULNS_SUCCESS,
                ASSET_VULNS_ERROR
            ],
            processResponseBeforeDispatch: vulnsPreprocessor,
            // https://qa-develop.cloud.aws.tenablesecurity.com/workbenches/assets/9924062c-2279-43e4-8081-24846d5b8742/vulnerabilities?date_range=30
            request: `/workbenches/assets/${assetId}/vulnerabilities?date_range=${range}${filters}`
        }
    };
};
