// THIS WHOLE THING IS TEMPORARY
// https://jira.corp.tenablesecurity.com/browse/CI-21513

import { STANDARD_API_ACTION } from 'tio-alloy';

import {
    ASSET_EXPLOITABILITY_REQUEST,
    ASSET_EXPLOITABILITY_SUCCESS,
    ASSET_EXPLOITABILITY_ERROR
} from './types';

const exploitablityFilter =
`filter.0.quality=eq&filter.0.filter=plugin.attributes.exploit_available&filter.0.value=true&filter.search_type=and`;

export const fetchAssetExploitability = (assetId, range = 0, filters = exploitablityFilter) => {
    return {
        type: STANDARD_API_ACTION,
        meta: {
            types: [
                ASSET_EXPLOITABILITY_REQUEST,
                ASSET_EXPLOITABILITY_SUCCESS,
                ASSET_EXPLOITABILITY_ERROR
            ],
            request: `/workbenches/assets/${assetId}/vulnerabilities?date_range=${range}&${filters}`
        }
    };
};
