import React, { Component } from 'react';
import PropTypes from 'prop-types';
import { Table } from '@hivekit/table';
import { ExploitMalwareIcon } from '@hivekit/icon';

import { ImagesDetailMalwareMessages } from 'tio-container-security/modules/images/messages';

class ImagesDetailMalwareView extends Component {
    static propTypes = {
        // Redux data fields
        imageMalware: PropTypes.object.isRequired,
        isImageMalwareFetching: PropTypes.bool.isRequired,
        currentDetailImage: PropTypes.object.isRequired,

        // Dispatches
        fetchImageMalware: PropTypes.func.isRequired,

        intl: PropTypes.object.isRequired
    }

    render () {
        const { imageMalware, isImageMalwareFetching, intl } = this.props;
        const { columnInfectedFile, columnFileType, columnMD5, columnSHA256 } = ImagesDetailMalwareMessages;
        const malwareColumns = [
            {
                headerName: intl.formatMessage(columnInfectedFile),
                field: 'file',
                suppressSorting: true
            },
            {
                headerName: intl.formatMessage(columnFileType),
                field: 'type',
                suppressSorting: true
            },
            {
                headerName: intl.formatMessage(columnMD5),
                field: 'md5',
                suppressSorting: true
            },
            {
                headerName: intl.formatMessage(columnSHA256),
                field: 'sha256',
                suppressSorting: true
            }
        ];

        const getCheckboxIcon = () => {
            return (
                <ExploitMalwareIcon />
            );
        };

        const malwareTableProps = {
            allowSelection: true,
            rows: imageMalware.malware,
            columns: malwareColumns,
            checkboxIconComponent: getCheckboxIcon,
            fetching: isImageMalwareFetching,
            error: imageMalware.errorMessage
        };

        return (
            <Table {...malwareTableProps}/>
        );
    }
}

export {
    ImagesDetailMalwareView
};
