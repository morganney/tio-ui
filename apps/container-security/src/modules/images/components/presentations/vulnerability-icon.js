import React from 'react';
import PropTypes from 'prop-types';
import {
    VulnHighIcon,
    VulnMediumIcon,
    VulnLowIcon
} from '@hivekit/icon';

const VulnIconView = ({ riskScore, size }) => {
    /*
    Icons are mapped in this way, based on risk score:
    [0, 4): low (green)
    [4, 7): medium (yellow)
    7+: high (red)
    */
    const lowRiskCap = 4;
    const mediumRiskCap = 7;
    let Icon = VulnLowIcon;

    // Assume low severity, and elevate as needed with simple, stacking comparisons
    if (riskScore && riskScore >= lowRiskCap) {
        Icon = VulnMediumIcon;
    }

    if (riskScore && riskScore >= mediumRiskCap) {
        Icon = VulnHighIcon;
    }

    return (
        <Icon size={size}/>
    );
};

VulnIconView.propTypes = {
    riskScore: PropTypes.any,
    size: PropTypes.number
};

export {
    VulnIconView
};
